# Usamos una imagen oficial de PHP 8.4 que ya incluye Apache.
FROM php:8.4-apache

# 1. Instalar dependencias del sistema y extensiones de PHP
# - libxslt-dev para la extensión xsl
# - libsqlite3-dev para pdo_sqlite
# - libzip-dev ya no es estrictamente necesario, pero es una extensión común. La dejamos por si acaso.
RUN apt-get update && apt-get install -y \
    libxslt-dev \
    libsqlite3-dev \
    libzip-dev

# Instala las extensiones de PHP que necesitamos
RUN docker-php-ext-install pdo_sqlite xsl zip

# 2. Habilitar mod_rewrite de Apache para URLs amigables
RUN a2enmod rewrite

# 3. Copiar nuestra configuración de VirtualHost personalizada
COPY docker/apache-vhost-dev.conf /etc/apache2/sites-available/000-default.conf

# 4. Establecer el directorio de trabajo
WORKDIR /var/www/html